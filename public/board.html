<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>광장 게시판</title>
</head>
<body>
    <h1>📢 광장 게시판</h1>

    <h2>글 작성</h2>
    <input id="title" placeholder="제목"><br />
    <textarea id="content" placeholder="내용"></textarea><br />
    <button onclick="writePost()">작성하기</button>

    <h2>📄 전체 글 목록</h2>
    <div id="posts"></div>

    <script>
        const user = JSON.parse(localStorage.getItem("user"));
        if (!user) {
            alert("로그인이 필요합니다!");
            window.location.href = "/login.html";
        }

        function isUserBanned() {
            return user.bannedUntil && new Date(user.bannedUntil) > new Date();
        }

        async function writePost() {
            if (isUserBanned()) {
                alert("밴된 유저는 글을 작성할 수 없습니다.");
                return;
            }

            const title = document.getElementById("title").value;
            const content = document.getElementById("content").value;

            const res = await fetch("/post", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    title,
                    content,
                    author: user.name,
                    grade: user.grade
                })
            });

            const msg = await res.text();
            alert(msg);
            loadPosts();
        }

        // 이후 나머지 함수 (loadPosts, votePost, deletePost 등) 를 이 아래에 위치시키세요.
    </script>

</body>
</html>